"use strict";!function(e,t){var n=e.History=e.History||{},r=e.jQuery;if("undefined"!=typeof n.Adapter)throw new Error("History.js Adapter has already been loaded...");n.Adapter={"bind":function(e,t,n){r(e).bind(t,n)},"trigger":function(e,t,n){r(e).trigger(t,n)},"extractEventData":function(e,n,r){var i=n&&n.originalEvent&&n.originalEvent[e]||r&&r[e]||t;return i},"onDomLoad":function(e){r(e)}},"undefined"!=typeof n.init&&n.init()}(window),function(e){var t=e.document,n=e.setTimeout||n,r=e.clearTimeout||r,i=e.setInterval||i,o=e.History=e.History||{};if("undefined"!=typeof o.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");o.initHtml4=function(){return"undefined"!=typeof o.initHtml4.initialized?!1:(o.initHtml4.initialized=!0,o.enabled=!0,o.savedHashes=[],o.isLastHash=function(e){var t,n=o.getHashByIndex();return t=e===n},o.isHashEqual=function(e,t){return e=encodeURIComponent(e).replace(/%25/g,"%"),t=encodeURIComponent(t).replace(/%25/g,"%"),e===t},o.saveHash=function(e){return o.isLastHash(e)?!1:(o.savedHashes.push(e),!0)},o.getHashByIndex=function(e){var t=null;return t="undefined"==typeof e?o.savedHashes[o.savedHashes.length-1]:0>e?o.savedHashes[o.savedHashes.length+e]:o.savedHashes[e]},o.discardedHashes={},o.discardedStates={},o.discardState=function(e,t,n){var r,i=o.getHashByState(e);return r={"discardedState":e,"backState":n,"forwardState":t},o.discardedStates[i]=r,!0},o.discardHash=function(e,t,n){var r={"discardedHash":e,"backState":n,"forwardState":t};return o.discardedHashes[e]=r,!0},o.discardedState=function(e){var t,n=o.getHashByState(e);return t=o.discardedStates[n]||!1},o.discardedHash=function(e){var t=o.discardedHashes[e]||!1;return t},o.recycleState=function(e){var t=o.getHashByState(e);return o.discardedState(e)&&delete o.discardedStates[t],!0},o.emulated.hashChange&&(o.hashChangeInit=function(){o.checkerFunction=null;var n,r,a,s,c="",l=Boolean(o.getHash());return o.isInternetExplorer()?(n="historyjs-iframe",r=t.createElement("iframe"),r.setAttribute("id",n),r.setAttribute("src","#"),r.style.display="none",t.body.appendChild(r),r.contentWindow.document.open(),r.contentWindow.document.close(),a="",s=!1,o.checkerFunction=function(){if(s)return!1;s=!0;var t=o.getHash(),n=o.getHash(r.contentWindow.document);return t!==c?(c=t,n!==t&&(a=n=t,r.contentWindow.document.open(),r.contentWindow.document.close(),r.contentWindow.document.location.hash=o.escapeHash(t)),o.Adapter.trigger(e,"hashchange")):n!==a&&(a=n,l&&""===n?o.back():o.setHash(n,!1)),s=!1,!0}):o.checkerFunction=function(){var t=o.getHash()||"";return t!==c&&(c=t,o.Adapter.trigger(e,"hashchange")),!0},o.intervalList.push(i(o.checkerFunction,o.options.hashChangeInterval)),!0},o.Adapter.onDomLoad(o.hashChangeInit)),o.emulated.pushState&&(o.onHashChange=function(t){var n,r=t&&t.newURL||o.getLocationHref(),i=o.getHashByUrl(r),a=null,s=null;return o.isLastHash(i)?(o.busy(!1),!1):(o.doubleCheckComplete(),o.saveHash(i),i&&o.isTraditionalAnchor(i)?(o.Adapter.trigger(e,"anchorchange"),o.busy(!1),!1):(a=o.extractState(o.getFullUrl(i||o.getLocationHref()),!0),o.isLastSavedState(a)?(o.busy(!1),!1):(s=o.getHashByState(a),(n=o.discardedState(a))?(o.getHashByIndex(-2)===o.getHashByState(n.forwardState)?o.back(!1):o.forward(!1),!1):(o.pushState(a.data,a.title,encodeURI(a.url),!1),!0))))},o.Adapter.bind(e,"hashchange",o.onHashChange),o.pushState=function(t,n,r,i){if(r=encodeURI(r).replace(/%25/g,"%"),o.getHashByUrl(r))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(i!==!1&&o.busy())return o.pushQueue({"scope":o,"callback":o.pushState,"args":arguments,"queue":i}),!1;o.busy(!0);var a=o.createStateObject(t,n,r),s=o.getHashByState(a),c=o.getState(!1),l=o.getHashByState(c),u=o.getHash(),d=o.expectedStateId==a.id;return o.storeState(a),o.expectedStateId=a.id,o.recycleState(a),o.setTitle(a),s===l?(o.busy(!1),!1):(o.saveState(a),d||o.Adapter.trigger(e,"statechange"),o.isHashEqual(s,u)||o.isHashEqual(s,o.getShortUrl(o.getLocationHref()))||o.setHash(s,!1),o.busy(!1),!0)},o.replaceState=function(t,n,r,i){if(r=encodeURI(r).replace(/%25/g,"%"),o.getHashByUrl(r))throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).");if(i!==!1&&o.busy())return o.pushQueue({"scope":o,"callback":o.replaceState,"args":arguments,"queue":i}),!1;o.busy(!0);var a=o.createStateObject(t,n,r),s=o.getHashByState(a),c=o.getState(!1),l=o.getHashByState(c),u=o.getStateByIndex(-2);return o.discardState(c,a,u),s===l?(o.storeState(a),o.expectedStateId=a.id,o.recycleState(a),o.setTitle(a),o.saveState(a),o.Adapter.trigger(e,"statechange"),o.busy(!1)):o.pushState(a.data,a.title,a.url,!1),!0}),o.emulated.pushState&&o.getHash()&&!o.emulated.hashChange&&o.Adapter.onDomLoad(function(){o.Adapter.trigger(e,"hashchange")}),void 0)},"undefined"!=typeof o.init&&o.init()}(window),function(e,t){var n=e.console||t,r=e.document,i=e.navigator,o=!1,a=e.setTimeout,s=e.clearTimeout,c=e.setInterval,l=e.clearInterval,u=e.JSON,d=e.alert,p=e.History=e.History||{},f=e.history;try{o=e.sessionStorage,o.setItem("TEST","1"),o.removeItem("TEST")}catch(h){o=!1}if(u.stringify=u.stringify||u.encode,u.parse=u.parse||u.decode,"undefined"!=typeof p.init)throw new Error("History.js Core has already been loaded...");p.init=function(){return"undefined"==typeof p.Adapter?!1:("undefined"!=typeof p.initCore&&p.initCore(),"undefined"!=typeof p.initHtml4&&p.initHtml4(),!0)},p.initCore=function(){if("undefined"!=typeof p.initCore.initialized)return!1;if(p.initCore.initialized=!0,p.options=p.options||{},p.options.hashChangeInterval=p.options.hashChangeInterval||100,p.options.safariPollInterval=p.options.safariPollInterval||500,p.options.doubleCheckInterval=p.options.doubleCheckInterval||500,p.options.disableSuid=p.options.disableSuid||!1,p.options.storeInterval=p.options.storeInterval||1e3,p.options.busyDelay=p.options.busyDelay||250,p.options.debug=p.options.debug||!1,p.options.initialTitle=p.options.initialTitle||r.title,p.options.html4Mode=p.options.html4Mode||!1,p.options.delayInit=p.options.delayInit||!1,p.intervalList=[],p.clearAllIntervals=function(){var e,t=p.intervalList;if("undefined"!=typeof t&&null!==t){for(e=0;e<t.length;e++)l(t[e]);p.intervalList=null}},p.debug=function(){p.options.debug&&p.log.apply(p,arguments)},p.log=function(){var e,t,i,o,a,s=!("undefined"==typeof n||"undefined"==typeof n.log||"undefined"==typeof n.log.apply),c=r.getElementById("log");for(s?(o=Array.prototype.slice.call(arguments),e=o.shift(),"undefined"!=typeof n.debug?n.debug.apply(n,[e,o]):n.log.apply(n,[e,o])):e="\n"+arguments[0]+"\n",t=1,i=arguments.length;i>t;++t){if(a=arguments[t],"object"==typeof a&&"undefined"!=typeof u)try{a=u.stringify(a)}catch(l){}e+="\n"+a+"\n"}return c?(c.value+=e+"\n-----\n",c.scrollTop=c.scrollHeight-c.clientHeight):s||d(e),!0},p.getInternetExplorerMajorVersion=function(){var e=p.getInternetExplorerMajorVersion.cached="undefined"!=typeof p.getInternetExplorerMajorVersion.cached?p.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=r.createElement("div"),n=t.getElementsByTagName("i");(t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->")&&n[0];);return e>4?e:!1}();return e},p.isInternetExplorer=function(){var e=p.isInternetExplorer.cached="undefined"!=typeof p.isInternetExplorer.cached?p.isInternetExplorer.cached:Boolean(p.getInternetExplorerMajorVersion());return e},p.emulated=p.options.html4Mode?{"pushState":!0,"hashChange":!0}:{"pushState":!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(i.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(i.userAgent))),"hashChange":Boolean(!("onhashchange"in e||"onhashchange"in r)||p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8)},p.enabled=!p.emulated.pushState,p.bugs={"setHash":Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===i.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),"safariPoll":Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===i.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(i.userAgent)),"ieDoubleCheck":Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8),"hashEscape":Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<7)},p.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},p.cloneObject=function(e){var t,n;return e?(t=u.stringify(e),n=u.parse(t)):n={},n},p.getRootUrl=function(){var e=r.location.protocol+"//"+(r.location.hostname||r.location.host);return r.location.port&&(e+=":"+r.location.port),e+="/"},p.getBaseHref=function(){var e=r.getElementsByTagName("base"),t=null,n="";return 1===e.length&&(t=e[0],n=t.href.replace(/[^\/]+$/,"")),n=n.replace(/\/+$/,""),n&&(n+="/"),n},p.getBaseUrl=function(){var e=p.getBaseHref()||p.getBasePageUrl()||p.getRootUrl();return e},p.getPageUrl=function(){var e,t=p.getState(!1,!1),n=(t||{}).url||p.getLocationHref();return e=n.replace(/\/+$/,"").replace(/[^\/]+$/,function(e){return/\./.test(e)?e:e+"/"})},p.getBasePageUrl=function(){var e=p.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/";return e},p.getFullUrl=function(e,t){var n=e,r=e.substring(0,1);return t="undefined"==typeof t?!0:t,/[a-z]+\:\/\//.test(e)||(n="/"===r?p.getRootUrl()+e.replace(/^\/+/,""):"#"===r?p.getPageUrl().replace(/#.*/,"")+e:"?"===r?p.getPageUrl().replace(/[\?#].*/,"")+e:t?p.getBaseUrl()+e.replace(/^(\.\/)+/,""):p.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),n.replace(/\#$/,"")},p.getShortUrl=function(e){var t=e,n=p.getBaseUrl(),r=p.getRootUrl();return p.emulated.pushState&&(t=t.replace(n,"")),t=t.replace(r,"/"),p.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},p.getLocationHref=function(e){return e=e||r,e.URL===e.location.href?e.location.href:e.location.href===decodeURIComponent(e.URL)?e.URL:e.location.hash&&decodeURIComponent(e.location.href.replace(/^[^#]+/,""))===e.location.hash?e.location.href:-1==e.URL.indexOf("#")&&-1!=e.location.href.indexOf("#")?e.location.href:e.URL||e.location.href},p.store={},p.idToState=p.idToState||{},p.stateToId=p.stateToId||{},p.urlToId=p.urlToId||{},p.storedStates=p.storedStates||[],p.savedStates=p.savedStates||[],p.normalizeStore=function(){p.store.idToState=p.store.idToState||{},p.store.urlToId=p.store.urlToId||{},p.store.stateToId=p.store.stateToId||{}},p.getState=function(e,t){"undefined"==typeof e&&(e=!0),"undefined"==typeof t&&(t=!0);var n=p.getLastSavedState();return!n&&t&&(n=p.createStateObject()),e&&(n=p.cloneObject(n),n.url=n.cleanUrl||n.url),n},p.getIdByState=function(e){var t,n=p.extractId(e.url);if(!n)if(t=p.getStateString(e),"undefined"!=typeof p.stateToId[t])n=p.stateToId[t];else if("undefined"!=typeof p.store.stateToId[t])n=p.store.stateToId[t];else{for(;;)if(n=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof p.idToState[n]&&"undefined"==typeof p.store.idToState[n])break;p.stateToId[t]=n,p.idToState[n]=e}return n},p.normalizeState=function(e){var t,n;return e&&"object"==typeof e||(e={}),"undefined"!=typeof e.normalized?e:(e.data&&"object"==typeof e.data||(e.data={}),t={},t.normalized=!0,t.title=e.title||"",t.url=p.getFullUrl(e.url?e.url:p.getLocationHref()),t.hash=p.getShortUrl(t.url),t.data=p.cloneObject(e.data),t.id=p.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,n=!p.isEmptyObject(t.data),(t.title||n)&&p.options.disableSuid!==!0&&(t.hash=p.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id),t.hashedUrl=p.getFullUrl(t.hash),(p.emulated.pushState||p.bugs.safariPoll)&&p.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t)},p.createStateObject=function(e,t,n){var r={"data":e,"title":t,"url":n};return r=p.normalizeState(r)},p.getStateById=function(e){e=String(e);var n=p.idToState[e]||p.store.idToState[e]||t;return n},p.getStateString=function(e){var t,n,r;return t=p.normalizeState(e),n={"data":t.data,"title":e.title,"url":e.url},r=u.stringify(n)},p.getStateId=function(e){var t,n;return t=p.normalizeState(e),n=t.id},p.getHashByState=function(e){var t,n;return t=p.normalizeState(e),n=t.hash},p.extractId=function(e){var t,n,r,i;return i=-1!=e.indexOf("#")?e.split("#")[0]:e,n=/(.*)\&_suid=([0-9]+)$/.exec(i),r=n?n[1]||e:e,t=n?String(n[2]||""):"",t||!1},p.isTraditionalAnchor=function(e){var t=!/[\/\?\.]/.test(e);return t},p.extractState=function(e,t){var n,r,i=null;return t=t||!1,n=p.extractId(e),n&&(i=p.getStateById(n)),i||(r=p.getFullUrl(e),n=p.getIdByUrl(r)||!1,n&&(i=p.getStateById(n)),i||!t||p.isTraditionalAnchor(e)||(i=p.createStateObject(null,null,r))),i},p.getIdByUrl=function(e){var n=p.urlToId[e]||p.store.urlToId[e]||t;return n},p.getLastSavedState=function(){return p.savedStates[p.savedStates.length-1]||t},p.getLastStoredState=function(){return p.storedStates[p.storedStates.length-1]||t},p.hasUrlDuplicate=function(e){var t,n=!1;return t=p.extractState(e.url),n=t&&t.id!==e.id},p.storeState=function(e){return p.urlToId[e.url]=e.id,p.storedStates.push(p.cloneObject(e)),e},p.isLastSavedState=function(e){var t,n,r,i=!1;return p.savedStates.length&&(t=e.id,n=p.getLastSavedState(),r=n.id,i=t===r),i},p.saveState=function(e){return p.isLastSavedState(e)?!1:(p.savedStates.push(p.cloneObject(e)),!0)},p.getStateByIndex=function(e){var t=null;return t="undefined"==typeof e?p.savedStates[p.savedStates.length-1]:0>e?p.savedStates[p.savedStates.length+e]:p.savedStates[e]},p.getCurrentIndex=function(){var e=null;return e=p.savedStates.length<1?0:p.savedStates.length-1},p.getHash=function(e){var t,n=p.getLocationHref(e);return t=p.getHashByUrl(n)},p.unescapeHash=function(e){var t=p.normalizeHash(e);return t=decodeURIComponent(t)},p.normalizeHash=function(e){var t=e.replace(/[^#]*#/,"").replace(/#.*/,"");return t},p.setHash=function(e,t){var n,i;return t!==!1&&p.busy()?(p.pushQueue({"scope":p,"callback":p.setHash,"args":arguments,"queue":t}),!1):(p.busy(!0),n=p.extractState(e,!0),n&&!p.emulated.pushState?p.pushState(n.data,n.title,n.url,!1):p.getHash()!==e&&(p.bugs.setHash?(i=p.getPageUrl(),p.pushState(null,null,i+"#"+e,!1)):r.location.hash=e),p)},p.escapeHash=function(t){var n=p.normalizeHash(t);return n=e.encodeURIComponent(n),p.bugs.hashEscape||(n=n.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),n},p.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=p.unescapeHash(t)},p.setTitle=function(e){var t,n=e.title;n||(t=p.getStateByIndex(0),t&&t.url===e.url&&(n=t.title||p.options.initialTitle));try{r.getElementsByTagName("title")[0].innerHTML=n.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(i){}return r.title=n,p},p.queues=[],p.busy=function(e){if("undefined"!=typeof e?p.busy.flag=e:"undefined"==typeof p.busy.flag&&(p.busy.flag=!1),!p.busy.flag){s(p.busy.timeout);var t=function(){var e,n,r;if(!p.busy.flag)for(e=p.queues.length-1;e>=0;--e)n=p.queues[e],0!==n.length&&(r=n.shift(),p.fireQueueItem(r),p.busy.timeout=a(t,p.options.busyDelay))};p.busy.timeout=a(t,p.options.busyDelay)}return p.busy.flag},p.busy.flag=!1,p.fireQueueItem=function(e){return e.callback.apply(e.scope||p,e.args||[])},p.pushQueue=function(e){return p.queues[e.queue||0]=p.queues[e.queue||0]||[],p.queues[e.queue||0].push(e),p},p.queue=function(e,t){return"function"==typeof e&&(e={"callback":e}),"undefined"!=typeof t&&(e.queue=t),p.busy()?p.pushQueue(e):p.fireQueueItem(e),p},p.clearQueue=function(){return p.busy.flag=!1,p.queues=[],p},p.stateChanged=!1,p.doubleChecker=!1,p.doubleCheckComplete=function(){return p.stateChanged=!0,p.doubleCheckClear(),p},p.doubleCheckClear=function(){return p.doubleChecker&&(s(p.doubleChecker),p.doubleChecker=!1),p},p.doubleCheck=function(e){return p.stateChanged=!1,p.doubleCheckClear(),p.bugs.ieDoubleCheck&&(p.doubleChecker=a(function(){return p.doubleCheckClear(),p.stateChanged||e(),!0},p.options.doubleCheckInterval)),p},p.safariStatePoll=function(){var t,n=p.extractState(p.getLocationHref());if(!p.isLastSavedState(n))return t=n,t||(t=p.createStateObject()),p.Adapter.trigger(e,"popstate"),p},p.back=function(e){return e!==!1&&p.busy()?(p.pushQueue({"scope":p,"callback":p.back,"args":arguments,"queue":e}),!1):(p.busy(!0),p.doubleCheck(function(){p.back(!1)}),f.go(-1),!0)},p.forward=function(e){return e!==!1&&p.busy()?(p.pushQueue({"scope":p,"callback":p.forward,"args":arguments,"queue":e}),!1):(p.busy(!0),p.doubleCheck(function(){p.forward(!1)}),f.go(1),!0)},p.go=function(e,t){var n;if(e>0)for(n=1;e>=n;++n)p.forward(t);else{if(!(0>e))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(n=-1;n>=e;--n)p.back(t)}return p},p.emulated.pushState){var h=function(){};p.pushState=p.pushState||h,p.replaceState=p.replaceState||h}else p.onPopState=function(t,n){var r,i,o=!1,a=!1;return p.doubleCheckComplete(),(r=p.getHash())?(i=p.extractState(r||p.getLocationHref(),!0),i?p.replaceState(i.data,i.title,i.url,!1):(p.Adapter.trigger(e,"anchorchange"),p.busy(!1)),p.expectedStateId=!1,!1):(o=p.Adapter.extractEventData("state",t,n)||!1,a=o?p.getStateById(o):p.expectedStateId?p.getStateById(p.expectedStateId):p.extractState(p.getLocationHref()),a||(a=p.createStateObject(null,null,p.getLocationHref())),p.expectedStateId=!1,p.isLastSavedState(a)?(p.busy(!1),!1):(p.storeState(a),p.saveState(a),p.setTitle(a),p.Adapter.trigger(e,"statechange"),p.busy(!1),!0))},p.Adapter.bind(e,"popstate",p.onPopState),p.pushState=function(t,n,r,i){if(p.getHashByUrl(r)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&p.busy())return p.pushQueue({"scope":p,"callback":p.pushState,"args":arguments,"queue":i}),!1;p.busy(!0);var o=p.createStateObject(t,n,r);return p.isLastSavedState(o)?p.busy(!1):(p.storeState(o),p.expectedStateId=o.id,f.pushState(o.id,o.title,o.url),p.Adapter.trigger(e,"popstate")),!0},p.replaceState=function(t,n,r,i){if(p.getHashByUrl(r)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(i!==!1&&p.busy())return p.pushQueue({"scope":p,"callback":p.replaceState,"args":arguments,"queue":i}),!1;p.busy(!0);var o=p.createStateObject(t,n,r);return p.isLastSavedState(o)?p.busy(!1):(p.storeState(o),p.expectedStateId=o.id,f.replaceState(o.id,o.title,o.url),p.Adapter.trigger(e,"popstate")),!0};if(o){try{p.store=u.parse(o.getItem("History.store"))||{}}catch(g){p.store={}}p.normalizeStore()}else p.store={},p.normalizeStore();p.Adapter.bind(e,"unload",p.clearAllIntervals),p.saveState(p.storeState(p.extractState(p.getLocationHref(),!0))),o&&(p.onUnload=function(){var e,t,n;try{e=u.parse(o.getItem("History.store"))||{}}catch(r){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in p.idToState)p.idToState.hasOwnProperty(t)&&(e.idToState[t]=p.idToState[t]);for(t in p.urlToId)p.urlToId.hasOwnProperty(t)&&(e.urlToId[t]=p.urlToId[t]);for(t in p.stateToId)p.stateToId.hasOwnProperty(t)&&(e.stateToId[t]=p.stateToId[t]);p.store=e,p.normalizeStore(),n=u.stringify(e);try{o.setItem("History.store",n)}catch(i){if(i.code!==DOMException.QUOTA_EXCEEDED_ERR)throw i;o.length&&(o.removeItem("History.store"),o.setItem("History.store",n))}},p.intervalList.push(c(p.onUnload,p.options.storeInterval)),p.Adapter.bind(e,"beforeunload",p.onUnload),p.Adapter.bind(e,"unload",p.onUnload)),p.emulated.pushState||(p.bugs.safariPoll&&p.intervalList.push(c(p.safariStatePoll,p.options.safariPollInterval)),("Apple Computer, Inc."===i.vendor||"Mozilla"===(i.appCodeName||""))&&(p.Adapter.bind(e,"hashchange",function(){p.Adapter.trigger(e,"popstate")}),p.getHash()&&p.Adapter.onDomLoad(function(){p.Adapter.trigger(e,"hashchange")})))},p.options&&p.options.delayInit||p.init()}(window),function(){function e(){$(".pii").click(function(e){e.preventDefault();var t=$(this);t.addSpinner(),$.ajax({"type":"POST","url":"/admin/pii","data":{"field":t.data("pii"),"fkey":StackExchange.options.user.fkey},"success":function(e){t.replaceWith(e),StackExchange.moderator&&StackExchange.moderator.initIpAddressLookups&&StackExchange.moderator.initIpAddressLookups()},"complete":StackExchange.helpers.removeSpinner})})}StackExchange.user={"init":function(t){function n(){c.parent().hide(),l.hide()}function r(){n();var e=d.val();u.val()||!e||$(".pac-container").is(":visible")||s.getPlacePredictions({"input":e,"types":["geocode"]},function(t,n){if(""==u.val()&&e==d.val()){if(n!=google.maps.places.PlacesServiceStatus.OK||!t.length)return l.show(),void 0;for(var r=t[0],i=0;i<t.length;i++)if(t[i].description.toUpperCase()===e.toUpperCase()){r=t[i];break}c.data({"text":r.description,"place_id":r.place_id}).text(r.description).parent().show()}})}StackExchange.user.options=t=t||{},e(),History.Adapter.bind(window,"statechange",function(){var e=History.getState();e&&e.data&&e.data.query&&(e.data.query?i(e.data.query):e.url==window.location.href&&-1!=window.location.href.indexOf("?tab=")&&i(window.location.search.substr(1)))});var i=function(e){var n="/ajax/users/tab/"+t.userId+"?"+e;$.get(n,function(e){var t=$(e);$(".user-tab").replaceWith(t);var n=t.offset().top;n<$(window).scrollTop()&&$("html, body").animate({"scrollTop":n}),window.MathJax&&window.MathJax.Hub.Typeset($(".user-tab")[0])})};$(document).on("click",".js-user-tab-sorts .js-user-tab-sort, .user-tab-paging a",function(e){e.preventDefault();var t=$(this).attr("href"),n=t.split("?").pop();History.pushState({"query":n},document.title,t)}),$(document).on("click",".question-summary .question-counts",function(){window.location=$(this).closest(".question-summary").find("a.question-hyperlink").attr("href")}),$(".toggle-summary").click(function(){var e=$(this);"False"===e.data("expanded")?($.post("/ajax/users/profile-summary/"+t.userId,{"fkey":StackExchange.options.user.fkey,"action":"expand"}),$("#user-info-container").animate({"height":250},200,function(){$(this).css("height","auto")}),$("#small-user-info").fadeOut(50,function(){$("#large-user-info").fadeIn(50)}),e.text("less info"),e.data("expanded","True")):($.post("/ajax/users/profile-summary/"+t.userId,{"fkey":StackExchange.options.user.fkey,"action":"collapse"}),$("#user-info-container").animate({"height":60},200),$("#large-user-info").fadeOut(50,function(){$("#small-user-info").fadeIn(50)}),e.text("more info"),e.data("expanded","False"))});var o=function(e,n,r){if(!e.data("loading")){var i=e.attr("id").substr("user-panel-".length);e.fadeTo(200,.5).data("loading",!0),r.addSpinner(),$.ajax({"type":"GET","url":"/ajax/users/panel/"+i+"/"+t.userId+"?sort="+n,"dataType":"html","success":function(t){var n=e.prop("className"),r=$(t).prop("className",n);e.replaceWith(r),window.MathJax&&window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub,e.attr("id")])},"error":function(){e.data("loading",!1)}})}};$(document).on("click",".js-user-subtabs .js-user-subtab",function(){var e=$(this),t=e.closest(".js-user-panel"),n=e.attr("data-sort-id");(!n||n.length<1)&&(n=$.trim(e.text())),e.hasClass("js-selected")||o(t,n,t.find("h1"))}),$(document).on("change",".js-user-subtabs .js-user-select",function(){var e=$(this),t=e.closest(".js-user-panel");o(t,e.val(),t.find(".js-subheader"))}),$(document).on("click","#show-removed-rep",function(){$.post("/ajax/users/removed-rep-toggle/"+t.userId,{"fkey":StackExchange.options.user.fkey,"showRemoved":this.checked?"true":"false"},function(){window.location.reload(!0)})});var a=function(){var e=$(this);e.addSpinner({"position":"absolute"}),$.ajax({"type":"GET","url":"/users/popup/past-names/"+t.userId,"dataType":"html","success":function(e){var t=$(e);t.find(".popup-close").click(function(){t.fadeOutAndRemove()}),t.appendTo("#mainbar-full").center().fadeIn("fast")},"error":function(){e.parent().showErrorMessage("Unable to load popup - please try again")},"complete":StackExchange.helpers.removeSpinner})};if($(".prior-name-count").css("cursor","pointer").click(a),$("#user-edit-table").length||$(".devstory.js-onboarding").length){var s,c=$("#use-loc-result"),l=$("#loc-not-found"),u=$("input[name='LocationPlaceId']"),d=$("input[name='Location']");!StackExchange.options.site.isEnterprise&&window.google&&google.maps?(s=new google.maps.places.AutocompleteService,new google.maps.places.Autocomplete(d[0],{"types":["geocode"],"fields":["place_id","name","types"]}).addListener("place_changed",function(){u.val("G:"+this.getPlace().place_id),n()})):s={"getPlacePredictions":function(){}},d.on("blur",r).on("focus",n).typeWatch({"captureLength":-1,"callback":function(){u.val(""),r()}}),c.click(function(e){e.preventDefault();var t=c.data();$("#user-edit-table input[name='LocationPlaceId']").val(t.place_id),d.val(t.text),c.parent().hide()})}}}}(),function(){StackExchange.user.initRepGraphs=function(e,t){function n(e){var t=function(e){return e.full_day_name+", "+e.full_month_name+" "+e.day_number+", "+e.full_year}({"full_day_name":"{full_day_name}","full_month_name":"{full_month_name}","day_number":"{day_number}","full_year":"{full_year}"});return t.formatUnicorn({"full_day_name":S[e.getUTCDay()],"full_month_name":x[e.getUTCMonth()],"day_number":e.getUTCDate(),"full_year":e.getUTCFullYear()})}function r(e){var t=function(e){return e.short_month_name+" '"+e.short_year}({"short_month_name":"{short_month_name}","short_year":"{short_year}"});return t.formatUnicorn({"short_month_name":w[e.getUTCMonth()],"short_year":e.getUTCFullYear()%100})}function i(e){var t=function(e){return e.short_month_name+" "+e.day_number}({"short_month_name":"{short_month_name}","day_number":"{day_number}"});return t.formatUnicorn({"short_month_name":w[e.getUTCMonth()],"day_number":e.getUTCDate()})}function o(){var e=[];return e.push({"color":"var(--black-200)","width":1,"value":0,"zIndex":5}),u>200&&e.push({"color":"var(--black-300)","width":1,"value":200,"zIndex":5}),e}function a(e){var t=e.xAxis[0],n=t.min,r=t.max,i=this.xAxis[0];return i.removePlotBand("selected-area"),i.addPlotBand({"id":"selected-area","from":n,"to":r,"color":f}),s(this),!1}function s(e){function r(){var t=[],n=e.xAxis[0],r=n.plotLinesAndBands[0].options;return s=r.from,c=r.to,$.each(e.series[0].data,function(e,n){if(n.x>=s&&n.x<=c)t.push({"x":n.x,"y":Math.max(n.y,-50),"color":n.color,"realRep":n.realRep}),n.y<l&&(l=n.y),n.y>u&&(u=n.y);else if(n.x>c)return}),u>0&&200>u&&(u=200),t}function a(e){var n=e.point.options,r=$(".day-details");r.data("loading")||p&&p.x==n.x&&p.y==n.y||(r.html("").data("loading",!0).addSpinner(),$.ajax({"type":"GET","url":"/ajax/users/{userId}/rep/day/{epochTime}?sort=time&showFullDates=true".formatUnicorn({"userid":t,"epochTime":n.x/1e3}),"dataType":"html","success":function(e){var t=$(e);r.html(t),p=n;var i=t.height();(!f||i>f)&&(f=i,r.css("height",i))},"error":function(){r.showErrorMessage("An error occurred when loading rep info")},"complete":function(){StackExchange.helpers.removeSpinner(),r.data("loading",!1)}}))}var s,c,l=0,u=0,d=r();k?(k.yAxis[0].setExtremes(l,u,!1),k.xAxis[0].setExtremes(s,c,!1),k.series[0].setData(d)):k=new Highcharts.Chart({"chart":{"renderTo":"detail-graph","animation":!1,"defaultSeriesType":"column","backgroundColor":"var(--white)","plotBorderColor":"var(--black-200)","borderColor":"var(--powder-700)"},"series":[{"name":"rep","data":d,"color":"var(--green-600)"}],"plotOptions":{"series":{"animation":!1,"cursor":"pointer","allowPointSelect":!0,"shadow":!1,"stickyTracking":!0,"states":{"hover":{"enabled":!0,"brightness":.5}}},"column":{"pointPadding":.03,"groupPadding":0,"borderWidth":0,"events":{"click":a}}},"xAxis":{"type":"datetime","labels":{"rotation":0,"formatter":function(){return i(new Date(this.value))},"style":{"color":"var(--black-500)"}},"lineWidth":0,"min":s,"max":c,"startOnTick":!0,"endOnTick":!0},"yAxis":{"gridLineWidth":0,"plotLines":o(),"min":l,"max":u,"title":{"text":"reputation per day","style":{"color":"var(--powder-600)"}},"startOnTick":!1,"endOnTick":!1},"tooltip":{"useHTML":!0,"formatter":function(){return'<span style="font-size: 10px;">'+n(new Date(this.point.x))+"</span><br/>"+function(e){return 1==e.rep,e.begin_span+"rep:"+e.end_span+" <b>"+e.rep+"</b>"}({"begin_span":'<span style="color:'+this.series.color+'">',"end_span":"</span>","rep":this.point.realRep})},"backgroundColor":"var(--white)","style":{"lineHeight":"200%","padding":10,"color":"var(--black-750)"}},"title":{"text":null},"legend":{"enabled":!1},"credits":{"enabled":!1}});var p,f}for(var c=[],l=0,u=0,d=864e5,p=30*d,f="rgba(0, 70, 200, 0.2)",h=0;h<e.length;h++){var g=e[h],m=Date.UTC(g[0],g[1]-1,g[2]),v=g[3],b=Math.max(v,-50);l>b&&(l=b),b>u&&(u=b),c.push({"color":0>b?"var(--red-500)":"var(--green-600)","x":m,"y":b,"realRep":v})}var y,k,w={"0":"Jan","1":"Feb","2":"Mar","3":"Apr","4":"May","5":"Jun","6":"Jul","7":"Aug","8":"Sep","9":"Oct","10":"Nov","11":"Dec"},x={"0":"January","1":"February","2":"March","3":"April","4":"May","5":"June","6":"July","7":"August","8":"September","9":"October","10":"November","11":"December"},S={"0":"Sunday","1":"Monday","2":"Tuesday","3":"Wednesday","4":"Thursday","5":"Friday","6":"Saturday"},C=new Date,E=c[0][0]||c[0].x,j=Date.UTC(C.getUTCFullYear(),C.getUTCMonth(),C.getUTCDate()),T=j-p;1==c.length&&c.push([E-d,0]),E>T?E=T:$("#master-graph, #graph-help").show(),y=new Highcharts.Chart({"chart":{"renderTo":"master-graph","animation":!1,"reflow":!1,"borderWidth":0,"marginLeft":62,"backgroundColor":null,"zoomType":"x","events":{"selection":a}},"series":[{"data":c,"type":"column","color":"var(--green-600)"}],"plotOptions":{"series":{"animation":!1,"lineWidth":1,"marker":{"enabled":!1},"shadow":!1,"states":{"hover":{"lineWidth":1}},"enableMouseTracking":!1},"column":{"borderWidth":0,"pointPadding":0,"groupPadding":0}},"xAxis":{"type":"datetime","min":E,"max":j,"maxZoom":p,"plotBands":[{"id":"selected-area","from":T,"to":j,"color":f}],"title":{"text":null},"labels":{"formatter":function(){var e=new Date(this.value);return j-E>3*p?r(e):i(e)},"style":{"color":"var(--black-500)"}},"lineWidth":0},"yAxis":{"gridLineWidth":0,"labels":{"enabled":!1},"title":{"text":null},"plotLines":o(),"min":l,"max":u,"showFirstLabel":!1,"endOnTick":!1,"startOnTick":!1},"title":{"text":null},"legend":{"enabled":!1},"tooltip":{"formatter":function(){return!1}},"credits":{"enabled":!1},"exporting":{"enabled":!1}},function(e){s(e)})}}(),function(){function e(){$(".profile-picture-popup").fadeOutAndRemove(),$(document).unbind("click",t),$(document).unbind("keyup",n)}function t(t){var n=$(t.target);n.hasClass("profile-picture-popup")||n.parents(".profile-picture-popup").length||e()}function n(t){27==(t.keyCode||t.which)&&e()}function r(t,n,r,i,o,a){if(r){$(".js-change-picture").data("image-type",r);var s={"fkey":StackExchange.options.user.fkey,"imageType":r};o&&(s.noSave=o),$.post("/users/popup/change-picture/"+n,s,function(n){var s=$('.gravatar-wrapper-128,.gravatar-wrapper-32,.avatar-change[data-profile-type="'+n.profileImageType+'"]');t.find(".badge-earned-check").hide(),s.find(".badge-earned-check").show(),e(),StackExchange.helpers.addSpinner($("#change-picture-progress")),setTimeout(function(){o&&"ImgUr"===r&&a&&(n.imageUrl=a),s.find("img").attr("src",n.imageUrl.replace("&amp;","&")),$(".main-image").attr("src",n.imageUrl.replace("&amp;","&")),StackExchange.helpers.removeSpinner(),i&&i(n)},250)})}}function i(i,o,a){StackExchange.helpers.addSpinner($("#change-picture-progress"));var s=a?a():!1;$.get("/users/popup/change-picture/"+i,function(a){var c=$(a),l=$("#picture-popup");StackExchange.helpers.removeSpinner(),c.find(".avatar-change").click(function(e){r(c,i,$(this).attr("data-profile-type"),o,s),e.preventDefault()}),c.find("#avatar-upload").click(function(){StackExchange.imageUploader.createImageUploadBackground(),StackExchange.imageUploader.uploadImageDialog(function(e){StackExchange.imageUploader.removeImageUploadBackground(),e&&r(c,i,"ImgUr",o,s,e)},"/upload/profile-image/"+i+(s?"/true":"")),e()}),c.find("#profile-picture-cancel").click(function(t){e(),t.preventDefault()
}),l.empty(),c.appendTo(l),c.fadeIn("fast");var u=$(".js-change-picture").data("image-type"),d=c.find('a[data-profile-type="'+u+'"]');u&&d.length||(d=c),d.find(".badge-earned-check:first").show(),$(document).click(t),$(document).keyup(n)})}StackExchange.user.initProfilePicturePopup=function(e,t,n){$(".js-change-picture").click(function(){i(e,t,n)})}}(),function(){var e=StackExchange.user.userCardMessages={"nextPrivInfo":"","nextTagBadgeInfo":"","nextBadgeInfo":"","latestBadgeInfo":""};StackExchange.user.initUserCards=function(){var t={"type":"config","position":{"my":"top left","at":"top center","offsetTop":22,"offsetLeft":-20},"css":{"width":"250px"}};$("#top-cards").on("click","#rep-card-next",function(n){StackExchange.helpers.showMessage(this,e.nextPrivInfo,t),n.preventDefault()}),$("#top-cards").on("click",".js-rep-box-next-badge",function(n){var r=$.extend(!0,{},t);r.position.offsetLeft=-65,StackExchange.helpers.showMessage(this,e.nextTagBadgeInfo,r),StackExchange.gps.bindTrackClicks(".js-next-tag-badge-info-events"),n.preventDefault()}),$("#top-cards").on("click","#badge-card-last",function(n){var r=$.extend(!0,{},t);r.position.offsetTop=20,StackExchange.helpers.showMessage(this,e.latestBadgeInfo,r),n.preventDefault()}),$("#top-cards").on("click",".js-badge-select-popup",function(n){StackExchange.helpers.showMessage(this,e.nextBadgeInfo,t),StackExchange.gps.bindTrackClicks(".js-tracked-badge-popup"),n.preventDefault()})},StackExchange.user.nextBadgePopup=function(){function e(e){$.extend(f,e||{}),c=$(".js-badge-select-popup"),l=c.find(".js-badge-list-container"),u=c.find(".js-limited-badges-notice"),d=null,$(".js-filter-tabs a").click(function(){var e=$(this);return e.blur(),t(e),!1}),$(".js-search-text").typeWatch({"highlight":!1,"wait":500,"captureLength":-1,"callback":n}),f.allowSaving&&l.on("click",p,function(){a($(this))})}function t(e){e.hasClass("js-selected is-selected")||(e.siblings().removeClass("js-selected is-selected"),e.addClass("js-selected is-selected"),n())}function n(){var e=c.find(".js-filter-tabs .js-selected").data("filter-type"),t=$.trim(c.find(".js-search-text").val()),n=null;switch(e){case"Available":n=":not(.js-completed)";break;case"All":n="*";break;default:n=".js-badge-class-"+e}t&&(n+=':containsCI("'+t+'")');var i=r(t)||$.Deferred().resolve();i.done(function(){var e=l.find(".js-badge-progress"),t=e.filter(n).show();e.not(t).hide()})}function r(e){return e===h||0===u.length?null:(d||(d=o()),""===e?(i(d),u.show(),h="",null):$.ajax({"type":"GET","url":"/users/activity/next-badge-popup/filter-available-tag-badges","data":{"tagNameContains":e},"dataType":"html"}).done(function(t){u.hide(),h=e,""===$.trim(t)?o().remove():i(t)}).fail(function(){}))}function i(e){var t=o();t.length?t.first().before($(e)).end().remove():u.before($(e))}function o(){return l.find(p)}function a(e){var t=$(f.isTagBadge?".js-highlight-box-reputation":".js-highlight-box-badges"),n=null;return $.ajax({"type":"POST","url":"/users/activity/next-badge-popup/save","data":{"fkey":StackExchange.options.user.fkey,"badgeDatabaseName":e.data("badge-database-name"),"isTagBadge":f.isTagBadge},"dataType":"html"}).done(function(e){t.replaceWith(e)}).fail(function(e){n=e.responseText&&e.responseText.length<100?e.responseText:"An error occurred while saving; please try again"}).always(function(){StackExchange.helpers.closePopups(),n&&t.showErrorMessage(n,{"transient":!0})}),!1}function s(e,t,n){e.loadPopup({"url":"/users/activity/next-badge-popup?userId="+t+"&isTagBadge="+(n?"true":"false"),"target":$("#mainbar-full"),"lightbox":!0}).done(function(){var e=$("body").addClass("stop-scrolling");$(".popup").on("popupClose",function(){e.removeClass("stop-scrolling")})})}var c,l,u,d,p=".js-badge-progress:not(.js-completed)",f={"isTagBadge":!0,"allowSaving":!0,"completed":[],"available":[]},h="";return{"init":e,"load":s}}(),StackExchange.user.renderMiniGraph=function(e){function t(){l&&!l.is(":hover")&&l.fadeOutAndRemove()}function n(){var t=d3.mouse(this)[0],n=e[Math.round(o.invert(t))],r=a(n),i=$(".js-reputation-graph");l||(l=StackExchange.helpers.showMessage(i,u(n),{"type":"config tooltip","dismissable":!1,"position":{"at":"top left","my":"bottom left","offsetLeft":26+t,"offsetTop":r},"removing":function(){l=null}}),l.on("mouseout",function(){l&&l.fadeOutAndRemove()})),l.find(".message-text").html(u(n)),l.css({"left":30+t,"top":r-20})}var r=173,i=50,o=d3.scale.linear().domain([1,e.length]).range([0,r]),a=d3.scale.linear().domain([d3.min(e),d3.max(e)]).range([i-1,1]),s=d3.svg.line().x(function(e,t){return o(t)}).y(function(e){return a(e)}),c=d3.select("#reputationGraph").attr("width",r).attr("height",i);c.append("g").append("path").attr("class","line").attr("d",s(e)),c.append("rect").attr("class","overlay").attr("width",r).attr("height",i).on("mouseout",t).on("mousemove",n);var l,u=function(e){for(var t=String(e.toFixed(0)),n=t.split("."),r=n[0],i=/(\d+)(\d{3})(,|$)/;i.test(r);)r=r.replace(i,"$1,$2");return t=n.length>1?r+"."+n[1]:r}},StackExchange.user.chooseTracker=function(){function e(e){var t=e.closest(".js-choose-tracker"),n=e.hasClass("js-tracker-settings")?e:t.find(".js-tracker-settings"),r=n?t.find(".js-tracker-settings-menu"):e,i=!r.is(":visible");n.toggleClass("css-tooltip",!i),r.toggle(i)}function t(t){var r=t.closest(".js-choose-tracker"),i=t.closest(".js-tracker-settings-menu");if(!i.is(":working")){if(t.hasClass("is-selected"))return e(t),void 0;i.working(!0),t.addSpinner(),$.ajax({"type":"POST","url":"/users/activity/set-first-tracker/{trackerType}".formatUnicorn({"trackerType":t.data("tracker-type-id")}),"data":{"fkey":StackExchange.options.user.fkey},"dataType":"html","success":function(r){e(t),n(r)},"error":function(){r.showErrorMessage("An error has occurred; please try again"),e(t),i.working(!1),t.removeSpinner()}})}}function n(e){$(".js-highlight-box-reputation").fadeTo("fast",.4,function(){$(this).replaceWith($(e).css("opacity",.4)),$(".js-highlight-box-reputation").fadeTo("fast",1)})}var r=!1;return{"init":function(){r||(r=!0,$("#top-cards").on("click",".js-tracker-settings",function(){e($(this))}),$("#top-cards").on("click",".js-tracker-settings-item",function(){t($(this))}))}}}()}(),function(){StackExchange.user.initNewsletterModule=function(e){$("#newsletter-preview").click(function(){var e=$(window).height(),t=Math.min(600,e-100),n=$(['<div class="popup lightbox-panel" style="display:block">','<div class="popup-close">',$("<a>&times;</a>",{"title":"close this popup (or hit Esc)"}).prop("outerHTML"),"</div>",'<div id="newsleter-preview-pane" style="overflow: hidden; width: 660px; height: ',t,'px;">','<iframe src="',$(this).attr("href"),'&suppressPromotion=true" width="660" height="',t,'" frameborder="0"></iframe>',"</div>","</div>"].join(""));return $(this).loadPopup({"html":n,"target":$("body"),"lightbox":!0}),!1}),$("#newsletter-confirm").click(function(){var t=$(this);return StackExchange.helpers.addSpinner(t),$.ajax({"url":"/newsletter/resend-confirmation","type":"POST","data":{"fkey":StackExchange.options.user.fkey,"id":e},"dataType":"json","success":function(e){StackExchange.helpers.removeSpinner(t),t.replaceWith('<span style="font-weight: bold;">'+e+"</span>")},"error":function(){StackExchange.helpers.removeSpinner(t),t.parent().showErrorMessage("newsletter confirmation could not be re-sent")}}),!1});var t=$("#newsletter-subscribe").is(":checked");$("#email, #newsletter-subscribe").change(function(){var e=$("#newsletter-subscribe").is(":checked");e&&0==$.trim($("#email").val()).length?$("#newsletter-message").text("Please enter your email address to receive the weekly newsletter.").show():e!=t?$("#newsletter-message").text('Click "Save Profile" to save your newsletter preference.').show():$("#newsletter-message").hide()})}}(),function(){StackExchange.user.expandPostBody=function(e,t,n){function r(e){e.find("td.async-load:not(.load-prepped)").addClass("load-prepped").prepend('<a class="load-body expander-arrow-small-hide" style=""></a>&nbsp;').closest("tr").after('<tr class="loaded-body">'+t+'<td class="body-container" '+(n>0?'colspan="'+n+'" ':"")+"/></tr>")}function i(){var e,t,n=$(this).next().show().find(".body-container:first");if(!(n.find(".ajax-loader").length>0)){if(n.is(".body-loaded"))return e=n.find("div:first"),t=$(this).find(".load-body"),t.is(".hide-body")?a(n,e):o(n,e),void 0;n.addSpinner({"padding-left":"5px"});var i,s=$(this).find("td.async-load"),c=s.attr("id")||"";i=c.indexOf("enable-load-body-")>-1?c.replace(/^enable-load-body-(.+)$/,"/posts/$1/body"):c.indexOf("enable-load-revision-")>-1?c.replace(/^enable-load-revision-(.+)$/,"/revisions/$1"):s.data("load-url"),$.ajax({"type":"GET","url":i,"dataType":"html","success":function(t){e=$('<div style="display:none">'+t+"</div>"),r(e),n.append(e).trigger("bodyloaded"),o(n,e)},"error":function(e){n.showErrorMessage(e.responseText&&e.responseText.length<100?e.responseText:"Error occurred when loading post body",{"transient":409==e.status})},"complete":function(){n.removeSpinner()}})}}function o(e,t){e.css("padding","").height("auto").addClass("body-loaded"),s(e).addClass("hide-body expander-arrow-small-show"),t.fadeIn("fast")}function a(e,t){t.fadeOut("fast",function(){e.height(0).css("padding","0px"),s(e).removeClass("hide-body expander-arrow-small-show")})}function s(e){return e.closest("tr").prev().find(".load-body")}t=null==t?"":t,r($(e)),$('tr:has("td.body-container")').children().css("padding","0px"),$(e).on("click","tr:not(.loaded-body)",i),$(e).on("click","a.question-hyperlink, a.answer-hyperlink, div.user-details a",function(e){e.stopPropagation()})}}(),StackExchange.user.emailSettings=function(){function e(e){o=e.urls||{},$.fn.showConfirmation=function(){var e=$(this);return $(this).is(".js-confirmable")||(e=$(this).parents(".js-confirmable")),e.addClass("-success"),e.find(".-is-confirmed").show(),setTimeout(function(){e.length>0&&e[0].scrollIntoView()},500),this},$.fn.hideConfirmation=function(e){function t(){n.removeClass("-success"),n.find(".-is-confirmed").hide()}var n=$(this);return $(this).is(".js-confirmable")||(n=$(this).parents(".js-confirmable")),e?window.setTimeout(t,e):t(),this},$.fn.url=function(e){var t=$(this),n=t.parent(),r=t.data(e+"Url")||t.data(e+"-url");return r?r:n.length>0?n.url(e):o[e]},$.fn.removableItemsMatching=function(e){return this.find(".js-removable-item").filter(function(){return e.call(this,$(this))})},$(document).on("click",".js-unsubscribe-confirm",function(e){$.post({"url":$(this).url("unsubscribeAll"),"data":{"fkey":StackExchange.options.user.fkey}}).then(function(){StackExchange.options.isMobile?$(".js-overlay-trigger").prop("checked",!1).trigger("change"):a&&a.fadeOutAndRemove(),$(".js-unsubscribe,.js-frequency._off").prop("checked",!0)}),e.preventDefault()}),t(),$(".js-unsubscribed").showConfirmation().hideConfirmation(1e4),i()}function t(e){var r=$(e||document.body);r.find(".js-frequency").click(function(e){var t=$(this);$.post({"url":t.url("frequency"),"data":t.parents("form").serialize()}).then(function(){t.prop("checked",!0)}),e.preventDefault()}),r.find(".js-company-alerts-frequency").click(function(e){var t=$(this);$.post({"url":t.url("companyAlertsFrequency"),"data":t.parents("form").serialize()}).then(function(){t.prop("checked",!0)}),e.preventDefault()}),r.find(".js-subscribe").click(function(e){var t=$(this).hideConfirmation();$.post({"url":t.url("subscribe"),"data":t.parents("form").serialize()}).then(function(){t.prop("checked",!0)}),e.preventDefault()}),r.find(".js-unsubscribe").click(function(e){var t=$(this);$.post({"url":t.url("unsubscribe"),"data":t.parents("form").serialize()}).then(function(){t.prop("checked",!0)}),e.preventDefault()}),r.find(".js-toggle-personalization").click(function(e){var t=$(this),n=t.prop("checked");$.post({"url":t.url("personalizeNewsletter"),"data":t.parents("form").serialize()}).then(function(){t.prop("checked",n)}).fail(function(){t.prop("checked",!n)}),e.preventDefault()}),r.find(".js-unsubscribe-all").click(function(e){StackExchange.options.isMobile?$(".js-overlay-trigger").prop("checked",!0).trigger("change"):a=StackExchange.helpers.showMessage(this,$("#unsubscribe-all-popup").html(),{"tip":"none","cssClass":"unsubscribe-all-popup","type":"config","position":{"my":"bottom right","at":"bottom right","offsetTop":-30},"css":{"width":"300px"}}),e.preventDefault()}),r.find(".js-save-email").click(function(e){var n=$(this);n.attr("disabled",!0),$.post({"url":n.url("updateEmail"),"data":$(this).parents("form").serialize()}).then(function(e){var n=$($.parseHTML(e)),r=n.filter(".email-settings");$(".email-settings").replaceWith(r),t()}).always(function(){n.removeAttr("disabled")}),e.preventDefault()}),r.find(".js-resend-verification").click(function(e){var t=$(this);$.post({"url":"/email/resend-verification","data":{"fkey":StackExchange.options.user.fkey}}).then(function(){var e=t.parents(".message"),n=t.remove();e.html("We've resent your verification email. Click the link in the email we sent you."),e.append("&nbsp;"),e.append(n)}),e.preventDefault()}),r.find(".js-remove-from-list").click(function(e){var t=$(this);$.post({"url":t.url("removeItem"),"data":t.parents("form").serialize()}).then(function(){t.closest(".js-removable-item").remove(),n()}),e.preventDefault()})}function n(){$(".js-removable-item-section").each(function(){var e=$(this);0===e.find(".js-removable-item").length?e.addClass("-empty"):e.removeClass("-empty")})}function r(r){function i(e,t){return e.removableItemsMatching(function(e){var n=e.find("input[name=tags]").val();return-1!==t.indexOf(n)})}e(r);var o=$(".js-tag-section");o.each(function(){var e=$(this),r=e.find(".js-add-button"),a=e.find(".js-done-button"),s=e.find(".js-add-form"),c=s.find(".js-input"),l=s.find(".js-submit"),u=o.filter(function(){return $(this).data("site-id")===e.data("site-id")&&this!==e.get(0)});StackExchange.using("tagAutocomplete",function(){c.autocomplete(c.url("itemAutocomplete"),{"max":6,"dataType":"json","matchSubset":!1,"highlightItem":!0,"multiple":!0,"multipleSeparator":" ","matchContains":!0,"scroll":!0,"scrollHeight":300,"formatItem":function(e){return e[0]+" ("+e[1]+")"},"formatResult":function(e){return e[0]}})}),r.click(function(){r.addClass("dno"),a.removeClass("dno"),s.removeClass("dno"),c.each(function(){this.focus()})}),a.click(function(){r.removeClass("dno"),a.addClass("dno"),s.addClass("dno")}),l.click(function(r){r.preventDefault();var o=StackExchange.helpers.sanitizeAndSplitTags(c.val(),!0,!1);0!=o.length&&(l.addClass("is-loading"),$.ajax({"type":"POST","url":$(this).url("addItems"),"data":s.serialize(),"dataType":"html","success":function(r){e.find(".-settings").replaceWith(""+r),i(u,o).remove();var a=i(e,o).addClass("-highlight");setTimeout(function(){a.removeClass("-highlight")},20),n(),t(e.find(".-settings"))},"error":function(){},"complete":function(){l.removeClass("is-loading")}}),c.val(""))}),window.location.hash=="#"+e.attr("id")&&(r.addClass("dno"),a.removeClass("dno"),s.removeClass("dno"),/iPad|iPhone|iPod/g.test(navigator.userAgent)||$(window).on("load",function(){c.each(function(){this.focus()})}))})}function i(){$(".js-toggle-subscribe-all-questions").change(function(){var e=$(this),t=e.data("slug"),n="on"===e.val();console.log(StackExchange.options.user.fkey),$.ajax({"url":"/users/email/settings/toggle-subscribe-all-questions","method":"post","data":{"fkey":StackExchange.options.user.fkey,"enabled":n,"slug":t,"accountId":StackExchange.options.user.accountId}})})}var o={},a=null;return{"init":e,"initTagWatching":r}}(),StackExchange.user.initPreferences=function(){Stacks.addController("alpha-feature",{"targets":["status","loadingIndicator"],"toggle":function(e){var t=e.target.checked,n=$(this.loadingIndicatorTarget).addStacksSpinner("sm ml8"),r=$(this.statusTarget);$.post("/users/set-beta/"+this.data.get("name")+"/"+(t?"true":"false"),{"fkey":StackExchange.options.user.fkey,"userId":this.data.get("userId")}).done(function(t){var i=t.tester,o=!i&&t.candidate;n.removeSpinner(),e.target.checked=i||o,r.toggleClass("d-none",!o)})}})},StackExchange.user.followingTab=function(){function e(e){n(e)}function t(){r(),i()}function n(e){$(".js-select-post-type").on("change",function(){var t=StackExchange.options.site.routePrefix||"",n=t+"/users/"+e+"?tab=following";this.value&&(n+="&filter="+this.value);var r=$(".js-user-tab-sorts .js-selected").data("sort");r&&(n+="&sort="+encodeURIComponent(r)),window.location.href=n})}function r(){$(".js-unfollow-post").on("click",function(){var e=$(this),t=e.next(".js-follow-post"),n=e.data("postid");o(n,!0,function(){e.parents(".js-followed-post").find(".js-fade").addClass("o50"),e.addClass("d-none"),t.removeClass("d-none")})})}function i(){$(".js-follow-post").on("click",function(){var e=$(this),t=e.prev(".js-unfollow-post"),n=e.data("postid");o(n,!1,function(){e.parents(".js-followed-post").find(".js-fade").removeClass("o50"),e.addClass("d-none"),t.removeClass("d-none")})})}function o(e,t,n){var r="An error occurred while unfollowing. Please try again later.";$.ajax({"type":"POST","url":"/posts/"+e+"/vote/"+StackExchange.vote.voteTypeIds.follow+(t?"?undo=true":""),"data":{"fkey":StackExchange.options.user.fkey},"success":function(e){if(e.Success)n();else{var t=e.Message||r;StackExchange.helpers.showToast(t,{"dismissable":!0,"type":"danger"})}},"error":function(){StackExchange.helpers.showToast(r,{"dismissable":!0,"type":"danger"})}})}return{"initPostTypeFilter":e,"initActionButtons":t}}(),function(){StackExchange.user.saveAndPushProfile=function(){$("#push").val("true"),$("#user-edit-form").submit()},StackExchange.user.initMyLoginsRemoveLinks=function(e){var t=e.find(".js-remove-login");t.click(function(){if(confirm("Are you sure you want to remove this login from your account?")){var e=$(this),t=e.closest(".js-login"),n=t.find(".js-login-info");n.addSpinner({"padding":"0 3px"}),$.ajax({"type":"POST","url":"/users/popup/logins/"+StackExchange.user.options.accountId+"/remove","data":{"loginId":e.data("id"),"otherLoginId":e.data("alt-id"),"fkey":StackExchange.options.user.fkey},"dataType":"json","success":function(e){if(e.success){var n=t.closest(".js-login-group");t.remove(),0==n.find(".js-login").length&&n.remove()}else t.showErrorMessage(e.message||"Unable to remove login - please try again")},"error":function(){t.showErrorMessage("Unable to remove login - please try again")},"complete":StackExchange.helpers.removeSpinner})}})},StackExchange.user.initCareersLinkOverlay=function(e){function t(){r.closed&&(window.location.reload(),clearInterval(n))}var n,r;$("#link-existing-careers").on("click",function(i){r=window.open("http://"+e+"/users/link-account","1436380635335","width=850,height=920,toolbar=0,menubar=0,location=1,status=1,scrollbars=0,resizable=1,left=0,top=0"),n=setInterval(t,500),i.preventDefault()})}}();